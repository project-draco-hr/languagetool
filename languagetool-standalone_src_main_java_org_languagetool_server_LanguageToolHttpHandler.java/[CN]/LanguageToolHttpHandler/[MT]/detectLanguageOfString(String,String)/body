{
  if (text.length() < MIN_LENGTH_FOR_AUTO_DETECTION && fallbackLanguage != null) {
    print("Auto-detected language of text with length " + text.length() + " is not reasonably certain, using '"+ fallbackLanguage+ "' as fallback");
    return Language.getLanguageForShortName(fallbackLanguage);
  }
  final LanguageIdentifier identifier=new LanguageIdentifier(text);
  Language lang;
  try {
    lang=Language.getLanguageForShortName(identifier.getLanguage());
  }
 catch (  IllegalArgumentException e) {
    lang=Language.getLanguageForLocale(Locale.ENGLISH);
  }
  if (lang.getDefaultVariant() != null) {
    lang=lang.getDefaultVariant();
  }
  return lang;
}
