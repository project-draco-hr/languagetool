{
  ArrayList<String> ltRule=new ArrayList<String>();
  if (id != null && name != null) {
    ltRule.add(firstIndent + "<rule " + "id=\""+ id+ "\" name=\""+ name+ "\">");
  }
 else {
    ltRule.add(firstIndent + "<rule>");
  }
  if (type.equals("avoid")) {
    if (Boolean.parseBoolean(rule.get("casesensitive"))) {
      ltRule.add(secondIndent + "<pattern case_sensitive=\"yes\">");
    }
 else {
      ltRule.add(secondIndent + "<pattern>");
    }
    String[] pattern=rule.get("pattern").split("\\ +");
    if (isSpecialApostropheCase(pattern)) {
      List<HashMap<String,String>> twoRules=splitOffRegularWords(rule);
      List<String> twoRulesList=new ArrayList<String>();
      for (      HashMap<String,String> map : twoRules) {
        List<String> singleRule=ltRuleAsList(map,RuleConverter.getSuitableID(map),RuleConverter.getSuitableName(map),type);
        for (        String line : singleRule) {
          twoRulesList.add(line);
        }
      }
      return twoRulesList;
    }
    for (int i=0; i < pattern.length; i++) {
      String e=pattern[i];
      if (e.contains("'") && !e.contains("|")) {
        String[] temp=e.replaceAll("'"," ' ").split("\\ +");
        for (        String sTemp : temp) {
          ltRule=addTokenHelper(ltRule,sTemp,thirdIndentInt);
        }
      }
 else       if (e.contains("'") & e.contains("|")) {
        String[] temp=e.split("\\|");
        String prefixes="";
        String suffix="";
        for (        String sTemp : temp) {
          String[] splitSTemp=sTemp.split("'");
          prefixes=prefixes + splitSTemp[0] + "|";
          suffix=splitSTemp[1];
        }
        prefixes=prefixes.substring(0,prefixes.length() - 1);
        ltRule=addTokenHelper(ltRule,prefixes,thirdIndentInt);
        ltRule=addTokenHelper(ltRule,"'",thirdIndentInt);
        ltRule=addTokenHelper(ltRule,suffix,thirdIndentInt);
      }
 else {
        ltRule=addTokenHelper(ltRule,e,thirdIndentInt);
      }
    }
    ltRule.add(secondIndent + "</pattern>");
    ltRule.add(secondIndent + "<message>" + rule.get("explanation")+ "</message>");
    ltRule.add(firstIndent + "</rule>");
  }
 else   if (type.equals("default")) {
    if (Boolean.parseBoolean(rule.get("casesensitive"))) {
      ltRule.add(secondIndent + "<pattern case_sensitive=\"yes\">");
    }
 else {
      ltRule.add(secondIndent + "<pattern>");
    }
    String[] pattern=rule.get("pattern").split("\\ +");
    if (isSpecialApostropheCase(pattern)) {
      List<HashMap<String,String>> twoRules=splitOffRegularWords(rule);
      List<String> twoRulesList=new ArrayList<String>();
      for (      HashMap<String,String> map : twoRules) {
        List<String> singleRule=ltRuleAsList(map,RuleConverter.getSuitableID(map),RuleConverter.getSuitableName(map),type);
        for (        String line : singleRule) {
          twoRulesList.add(line);
        }
      }
      return twoRulesList;
    }
    for (int i=0; i < pattern.length; i++) {
      String e=pattern[i];
      if (e.contains("'") && !e.contains("|")) {
        String[] temp=e.replaceAll("'"," ' ").split("\\ +");
        for (        String sTemp : temp) {
          ltRule=addTokenHelper(ltRule,sTemp,thirdIndentInt);
        }
      }
 else       if (e.contains("'") & e.contains("|")) {
        String[] temp=e.split("\\|");
        String prefixes="";
        String suffix="";
        for (        String sTemp : temp) {
          String[] splitSTemp=sTemp.split("'");
          prefixes=prefixes + splitSTemp[0] + "|";
          suffix=splitSTemp[1];
        }
        prefixes=prefixes.substring(0,prefixes.length() - 1);
        ltRule=addTokenHelper(ltRule,prefixes,thirdIndentInt);
        ltRule=addTokenHelper(ltRule,"'",thirdIndentInt);
        ltRule=addTokenHelper(ltRule,suffix,thirdIndentInt);
      }
 else {
        ltRule=addTokenHelper(ltRule,e,thirdIndentInt);
      }
    }
    ltRule.add(secondIndent + "</pattern>");
    if (rule.containsKey("word")) {
      ltRule=addSuggestion(ltRule,rule.get("word"),pattern,secondIndentInt);
    }
    if (rule.containsKey("filter")) {
      if (rule.get("filter").equals("kill")) {
        ltRule.add(secondIndent + "<disambig action=\"immunize\"/>");
      }
    }
    ltRule.add(firstIndent + "</rule>");
  }
  return ltRule;
}
