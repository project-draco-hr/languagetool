{
  final GrammarCheckingResult paRes=new GrammarCheckingResult();
  paRes.nEndOfSentencePos=suggEndOfSentencePos - startOfSentencePos;
  paRes.xFlatParagraph=xPara;
  paRes.xGrammarChecker=this;
  paRes.aLocale=locale;
  paRes.nDocumentId=docID;
  paRes.aText=paraText;
  if (paraText != null) {
    paRes.nEndOfSentencePos=paraText.length();
  }
 else {
    return paRes;
  }
  if (hasLocale(locale)) {
    if (!Language.getLanguageForShortName(locale.Language).equals(docLanguage) || langTool == null) {
      docLanguage=Language.getLanguageForShortName(locale.Language);
      if (docLanguage == null) {
        return paRes;
      }
      try {
        langTool=new JLanguageTool(docLanguage,config.getMotherTongue());
        langTool.activateDefaultPatternRules();
        langTool.activateDefaultFalseFriendRules();
      }
 catch (      final Exception exception) {
        showError(exception);
      }
    }
    if (config.getDisabledRuleIds() != null) {
      for (      final String id : config.getDisabledRuleIds()) {
        langTool.disableRule(id);
      }
    }
    final Set<String> disabledCategories=config.getDisabledCategoryNames();
    if (disabledCategories != null) {
      for (      final String categoryName : disabledCategories) {
        langTool.disableCategory(categoryName);
      }
    }
    try {
      final List<RuleMatch> ruleMatches=langTool.check(paraText);
      if (ruleMatches.size() > 0) {
        final SingleGrammarError[] errorArray=new SingleGrammarError[ruleMatches.size()];
        ;
        int i=0;
        for (        final RuleMatch myRuleMatch : ruleMatches) {
          errorArray[i]=createOOoError(locale,myRuleMatch);
          i++;
        }
        paRes.aGrammarErrors=errorArray;
      }
    }
 catch (    final IOException exception) {
      showError(exception);
    }
  }
  return paRes;
}
