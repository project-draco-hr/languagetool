{
  if (textToCheck == null) {
    return;
  }
  final Language docLanguage=getLanguage();
  if (docLanguage == null) {
    return;
  }
  final ProgressDialog progressDialog=new ProgressDialog(MESSAGES);
  final CheckerThread checkerThread=new CheckerThread(textToCheck.paragraphs,docLanguage,config,progressDialog);
  checkerThread.start();
  while (true) {
    if (checkerThread.done()) {
      break;
    }
    try {
      Thread.sleep(100);
    }
 catch (    final InterruptedException e) {
    }
  }
  progressDialog.close();
  final List<CheckedParagraph> checkedParagraphs=checkerThread.getRuleMatches();
  if (checkedParagraphs.size() == 0) {
    String msg;
    final String translatedLangName=MESSAGES.getString(docLanguage.getShortName());
    if (textToCheck.isSelection) {
      msg=Tools.makeTexti18n(MESSAGES,"guiNoErrorsFoundSelectedText",new String[]{translatedLangName});
    }
 else {
      msg=Tools.makeTexti18n(MESSAGES,"guiNoErrorsFound",new String[]{translatedLangName});
    }
    final DialogThread dt=new DialogThread(msg);
    dt.start();
  }
 else {
    ResultDialogThread dialog;
    if (textToCheck.isSelection) {
      dialog=new ResultDialogThread(config,checkerThread.getLanguageTool().getAllRules(),xTextDoc,checkedParagraphs,xViewCursor,textToCheck);
    }
 else {
      dialog=new ResultDialogThread(config,checkerThread.getLanguageTool().getAllRules(),xTextDoc,checkedParagraphs,null,null);
    }
    dialog.start();
  }
}
