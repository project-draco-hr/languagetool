{
  final XTextDocument xTextDoc=(XTextDocument)UnoRuntime.queryInterface(XTextDocument.class,getxComponent());
  com.sun.star.container.XEnumerationAccess xParaAccess=(com.sun.star.container.XEnumerationAccess)UnoRuntime.queryInterface(com.sun.star.container.XEnumerationAccess.class,xTextDoc.getText());
  if (xParaAccess == null) {
    System.err.println("xParaAccess == null");
    return new TextToCheck(new ArrayList<String>(),false);
  }
  XModel xModel=(XModel)UnoRuntime.queryInterface(XModel.class,xTextDoc);
  if (xModel == null) {
    DialogThread dt=new DialogThread("Sorry, only text documents are supported");
    dt.start();
    return null;
  }
  XTextViewCursorSupplier xViewCursorSupplier=(XTextViewCursorSupplier)UnoRuntime.queryInterface(XTextViewCursorSupplier.class,xModel.getCurrentController());
  xViewCursor=xViewCursorSupplier.getViewCursor();
  String textToCheck=xViewCursor.getString();
  if (textToCheck.equals("")) {
  }
 else {
    List<String> l=new ArrayList<String>();
    l.add(textToCheck);
    return new TextToCheck(l,true);
  }
  List<String> paragraphs=new ArrayList<String>();
  try {
    for (com.sun.star.container.XEnumeration xParaEnum=xParaAccess.createEnumeration(); xParaEnum.hasMoreElements(); ) {
      Object para=xParaEnum.nextElement();
      String paraString=getParagraphContent(para);
      if (paraString == null) {
        paragraphs.add("");
      }
 else {
        paragraphs.add(paraString);
      }
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return new TextToCheck(paragraphs,false);
}
