{
  if (xFlatPI == null) {
    return new TextToCheck(new ArrayList<String>(),false);
  }
  com.sun.star.text.XFlatParagraphIterator xParaAccess=xFlatPI.getFlatParagraphIterator(com.sun.star.text.TextMarkupType.GRAMMAR,false);
  if (xParaAccess == null) {
    System.err.println("xParaAccess == null");
    return new TextToCheck(new ArrayList<String>(),false);
  }
  List<String> paragraphs=new ArrayList<String>();
  try {
    com.sun.star.text.XFlatParagraph xParaEnum=xParaAccess.getFirstPara();
    String paraString=xParaEnum.getText();
    if (paraString == null) {
      paragraphs.add("");
    }
 else {
      paragraphs.add(paraString);
    }
    while (true) {
      xParaEnum=xParaAccess.getNextPara();
      if (xParaEnum != null) {
        paraString=xParaEnum.getText();
        if (paraString == null) {
          paragraphs.add("");
        }
 else {
          paragraphs.add(paraString);
        }
      }
 else {
        break;
      }
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return new TextToCheck(paragraphs,false);
}
