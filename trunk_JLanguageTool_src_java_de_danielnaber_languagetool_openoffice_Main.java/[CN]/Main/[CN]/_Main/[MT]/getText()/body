{
  XModel xModel=(XModel)UnoRuntime.queryInterface(XModel.class,xTextDoc);
  XController xController=xModel.getCurrentController();
  XTextViewCursorSupplier xViewCursorSupplier=(XTextViewCursorSupplier)UnoRuntime.queryInterface(XTextViewCursorSupplier.class,xController);
  xViewCursor=xViewCursorSupplier.getViewCursor();
  String textToCheck=xViewCursor.getString();
  boolean selection=true;
  if (textToCheck.equals("")) {
    selection=false;
    XText text=xTextDoc.getText();
    textToCheck=text.getString();
    xViewCursor=null;
  }
  textToCheck=textToCheck.replaceAll("\r\n","\n");
  return new TextToCheck(textToCheck,selection);
}
