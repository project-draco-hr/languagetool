{
  ProgressDialog progressDialog=new ProgressDialog();
  Language docLanguage=null;
  if (xTextDoc == null)   docLanguage=Language.ENGLISH;
 else   docLanguage=getLanguage();
  File baseDir=getBaseDir();
  Configuration config=new Configuration(baseDir);
  CheckerThread checkerThread=new CheckerThread(text,docLanguage,config,baseDir);
  checkerThread.start();
  while (true) {
    if (checkerThread.done()) {
      break;
    }
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
    }
  }
  progressDialog.close();
  List ruleMatches=checkerThread.getRuleMatches();
  if (ruleMatches.size() == 0) {
    JOptionPane.showMessageDialog(null,"No errors and warnings found (document language: " + docLanguage.getName() + ")");
  }
 else {
    OOoDialog dialog=new OOoDialog(config,checkerThread.getLanguageTool().getAllRules(),xTextDoc,ruleMatches,text,xViewCursor);
    dialog.show();
  }
}
