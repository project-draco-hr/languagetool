{
  XPropertySet xCursorProps=(XPropertySet)UnoRuntime.queryInterface(XPropertySet.class,xTextDoc.getText().createTextCursor());
  Locale charLocale=(Locale)xCursorProps.getPropertyValue("CharLocale");
  boolean langIsSupported=false;
  for (int i=0; i < Language.LANGUAGES.length; i++) {
    if (Language.LANGUAGES[i].getShortName().equals(charLocale.Language)) {
      langIsSupported=true;
      break;
    }
  }
  if (!langIsSupported) {
    JOptionPane.showMessageDialog(null,"Error: Sorry, the document language '" + charLocale.Language + "' is not supported by LanguageTool.");
    throw new IllegalArgumentException("Language is not supported: " + charLocale.Language);
  }
  return Language.getLanguageforShortName(charLocale.Language);
}
