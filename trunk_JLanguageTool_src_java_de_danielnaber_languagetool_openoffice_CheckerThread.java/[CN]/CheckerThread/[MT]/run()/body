{
  try {
    langTool=new JLanguageTool(docLanguage,config.getMotherTongue());
    langTool.activateDefaultPatternRules();
    langTool.activateDefaultFalseFriendRules();
    if (config.getDisabledRuleIds() != null) {
      for (      String id : config.getDisabledRuleIds()) {
        langTool.disableRule(id);
      }
    }
    Set<String> disabledCategories=config.getDisabledCategoryNames();
    if (disabledCategories != null) {
      for (      String categoryName : disabledCategories) {
        langTool.disableCategory(categoryName);
      }
    }
    int paraCount=0;
    for (    String para : paragraphs) {
      List<RuleMatch> ruleMatches=langTool.check(para);
      if (ruleMatches.size() > 0) {
        checkedParagraphs.add(new CheckedParagraph(paraCount,ruleMatches));
      }
      paraCount++;
      progressInfo.setProgress(paraCount);
    }
    done=true;
  }
 catch (  Exception e) {
    done=true;
    Main.showError(e);
  }
}
