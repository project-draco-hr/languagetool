{
  List<String> leftContext=getContext(token,tokens,term,2,0);
  List<String> leftContextSub=new ArrayList<>();
  if (leftContext.size() == 1) {
    leftContextSub=Arrays.asList();
  }
 else   if (leftContext.size() == 2) {
    leftContextSub=leftContext.subList(0,1);
  }
 else   if (leftContext.size() == 3) {
    leftContextSub=leftContext.subList(0,2);
  }
  List<String> rightContext=getContext(token,tokens,term,0,2);
  List<String> rightContextSub=new ArrayList<>();
  if (rightContext.size() == 3) {
    rightContextSub=rightContext.subList(1,3);
  }
 else {
    System.err.println("?? " + rightContext);
  }
  double res;
  if (leftContextSub.size() > 0 && rightContextSub.size() > 0) {
    res=((double)lm.getCount(leftContext) / (lm.getCount(leftContextSub) + 1) + (double)lm.getCount(rightContext) / (lm.getCount(rightContextSub) + 1)) / 2;
  }
 else   if (leftContextSub.size() > 0 && rightContextSub.size() == 0) {
    res=(double)lm.getCount(leftContext) / (lm.getCount(leftContextSub) + 1);
  }
 else   if (leftContextSub.size() == 0 && rightContextSub.size() > 0) {
    res=(double)lm.getCount(rightContext) / (lm.getCount(rightContextSub) + 1);
  }
 else {
    return (lm.getCount(leftContext) + lm.getCount(rightContext)) / 2.0f;
  }
  return res;
}
