{
  final String sql="INSERT INTO corpus_match " + "(version, language_code, ruleid, rule_category, rule_subid, rule_description, message, error_context, corpus_date, " + "check_date, sourceuri, source_type, is_visible) "+ "VALUES (0, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, 1)";
  try (PreparedStatement prepSt=conn.prepareStatement(sql)){
    final java.sql.Date nowDate=new java.sql.Date(new Date().getTime());
    for (    RuleMatch match : ruleMatches) {
      prepSt.setString(1,language.getShortName());
      final Rule rule=match.getRule();
      prepSt.setString(2,rule.getId());
      prepSt.setString(3,rule.getCategory().getName());
      if (rule instanceof PatternRule) {
        final PatternRule patternRule=(PatternRule)rule;
        prepSt.setString(4,patternRule.getSubId());
      }
 else {
        prepSt.setNull(4,Types.VARCHAR);
      }
      prepSt.setString(5,rule.getDescription());
      prepSt.setString(6,StringUtils.abbreviate(match.getMessage(),255));
      final String context=contextTools.getContext(match.getFromPos(),match.getToPos(),sentence.getText());
      if (context.length() > MAX_CONTEXT_LENGTH) {
        continue;
      }
      prepSt.setString(7,context);
      prepSt.setDate(8,nowDate);
      prepSt.setDate(9,nowDate);
      prepSt.setString(10,sentence.getUrl());
      prepSt.setString(11,sentence.getSource());
      prepSt.executeUpdate();
      checkMaxErrors(++errorCount);
      if (errorCount % 100 == 0) {
        System.out.println("Storing error #" + errorCount + " for text:");
        System.out.println("  " + sentence.getText());
      }
    }
    checkMaxSentences(++sentenceCount);
  }
 catch (  DocumentLimitReachedException|ErrorLimitReachedException e) {
    throw e;
  }
catch (  Exception e) {
    throw new RuntimeException("Error storing matches for '" + sentence.getTitle() + "'",e);
  }
}
