{
  RuleMatch match=(RuleMatch)ruleMatches.get(i);
  currentRuleMatch=match;
  currentRuleMatchPos=i;
  String msg=match.getMessage();
  msg=msg.replaceAll("<em>","<b>");
  msg=msg.replaceAll("</em>","</b>");
  StringBuilder sb=new StringBuilder();
  if (ruleMatches.size() == 1)   sb.append(ruleMatches.size() + " match in total");
 else   sb.append(ruleMatches.size() + " matches in total");
  sb.append("<br>\n<br>\n<b>" + (i + 1) + ".</b> ");
  sb.append("<b>Match:</b> ");
  sb.append(msg);
  sb.append("<br>\n");
  contextArea.setText(FONT_TAG + Tools.getContext(match.getFromPos(),match.getToPos(),text));
  messageArea.setText(FONT_TAG + sb.toString());
  setSuggestions();
  if (xTextDoc != null) {
    XModel xModel=(XModel)UnoRuntime.queryInterface(XModel.class,xTextDoc);
    XController xController=xModel.getCurrentController();
    XTextViewCursorSupplier xViewCursorSupplier=(XTextViewCursorSupplier)UnoRuntime.queryInterface(XTextViewCursorSupplier.class,xController);
    int errorLength=currentRuleMatch.getToPos() - currentRuleMatch.getFromPos();
    if (xViewCursor == null) {
      XTextViewCursor tmpxViewCursor=xViewCursorSupplier.getViewCursor();
      tmpxViewCursor.gotoStart(false);
      tmpxViewCursor.goRight((short)(currentRuleMatch.getFromPos() - replacementCorrection),false);
      tmpxViewCursor.goRight((short)errorLength,true);
    }
 else {
      if (startTextRange == null) {
        startTextRange=xViewCursor.getStart();
      }
      xViewCursor.gotoRange(startTextRange,false);
      xViewCursor.goRight((short)(currentRuleMatch.getFromPos() - replacementCorrection),false);
      xViewCursor.goRight((short)errorLength,true);
    }
  }
}
