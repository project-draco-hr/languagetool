{
  String replacement=(String)suggestionList.getSelectedValue();
  if (REPLACE_WITH_OTHER_TEXT.equals(replacement)) {
    ReplaceTextDialog replaceDialog=new ReplaceTextDialog();
    String replacementTextTmp=replaceDialog.getText();
    if (replacementTextTmp != null) {
      replacement=replacementTextTmp;
    }
 else {
      return;
    }
  }
  short errorLength=(short)(currentRuleMatch.getToPos() - currentRuleMatch.getFromPos());
  if (xViewCursor == null) {
    myViewCursor.setString(replacement);
  }
 else {
    if (startTextRange == null) {
      startTextRange=xViewCursor.getStart();
    }
    xViewCursor.gotoRange(startTextRange,false);
    xViewCursor.goRight((short)(currentRuleMatch.getFromPos() - replacementCorrection),false);
    xViewCursor.goRight((short)errorLength,true);
    xViewCursor.setString(replacement);
  }
  replacementCorrection+=errorLength - replacement.length();
  gotoNextMatch();
}
