{
  final List<RuleMatch> ruleMatches=new ArrayList<>();
  if (needsInit) {
    init();
  }
  if (dictionary == null) {
    return toRuleMatchArray(ruleMatches);
  }
  final String[] tokens=tokenizeText(getSentenceTextWithoutUrls(text));
  int len=text.getTokens()[1].getStartPos();
  for (  final String word : tokens) {
    if (ignoreWord(word)) {
      len+=word.length() + 1;
      continue;
    }
    boolean isAlphabetic=true;
    if (word.length() == 1) {
      isAlphabetic=StringTools.isAlphabetic(word.charAt(0));
    }
    if (isAlphabetic && !word.equals("--") && dictionary.misspelled(word)) {
      final RuleMatch ruleMatch=new RuleMatch(this,len,len + word.length(),messages.getString("spelling"),messages.getString("desc_spelling_short"));
      final List<String> suggestions=getSuggestions(word);
      if (suggestions != null) {
        ruleMatch.setSuggestedReplacements(suggestions);
      }
      ruleMatches.add(ruleMatch);
    }
    len+=word.length() + 1;
  }
  return toRuleMatchArray(ruleMatches);
}
