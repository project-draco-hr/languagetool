{
  List<RuleMatch> ruleMatches=new ArrayList<>();
  AnalyzedTokenReadings[] tokens=sentence.getTokensWithoutWhitespace();
  for (  AnalyzedTokenReadings tokenReadings : tokens) {
    if (tokenReadings.isImmunized() || tokenReadings.isIgnoredBySpeller()) {
      continue;
    }
    String originalTokenStr=tokenReadings.getToken();
    if (ignoreTaggedWords && isTagged(tokenReadings)) {
      continue;
    }
    String tokenString=cleanup(originalTokenStr);
    if (!getWrongWords().containsKey(tokenString) && checkLemmas) {
      for (      AnalyzedToken analyzedToken : tokenReadings.getReadings()) {
        String lemma=analyzedToken.getLemma();
        if (lemma != null) {
          lemma=cleanup(lemma);
          if (getWrongWords().containsKey(lemma)) {
            tokenString=lemma;
            break;
          }
        }
      }
    }
    List<String> possibleReplacements=getWrongWords().get(originalTokenStr);
    if (possibleReplacements == null) {
      possibleReplacements=getWrongWords().get(tokenString);
    }
    if (possibleReplacements != null && possibleReplacements.size() > 0) {
      List<String> replacements=new ArrayList<>();
      replacements.addAll(possibleReplacements);
      if (replacements.contains(originalTokenStr)) {
        replacements.remove(originalTokenStr);
      }
      if (replacements.size() > 0) {
        RuleMatch potentialRuleMatch=createRuleMatch(tokenReadings,replacements);
        ruleMatches.add(potentialRuleMatch);
      }
    }
  }
  return toRuleMatchArray(ruleMatches);
}
