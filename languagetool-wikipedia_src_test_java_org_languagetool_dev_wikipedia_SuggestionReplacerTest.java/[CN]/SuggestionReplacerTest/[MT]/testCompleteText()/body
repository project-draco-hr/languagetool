{
  InputStream stream=SuggestionReplacerTest.class.getResourceAsStream("/org/languagetool/dev/wikipedia/wikipedia.txt");
  String origMarkup=IOUtils.toString(stream);
  JLanguageTool langTool=new JLanguageTool(new GermanyGerman());
  langTool.disableRule(GermanSpellerRule.RULE_ID);
  langTool.disableRule("DE_AGREEMENT");
  langTool.disableRule("GERMAN_WORD_REPEAT_BEGINNING_RULE");
  langTool.disableRule("COMMA_PARENTHESIS_WHITESPACE");
  langTool.disableRule("DE_CASE");
  langTool.disableRule("ABKUERZUNG_LEERZEICHEN");
  langTool.disableRule("TYPOGRAFISCHE_ANFUEHRUNGSZEICHEN");
  SwebleWikipediaTextFilter filter=new SwebleWikipediaTextFilter();
  PlainTextMapping mapping=filter.filter(origMarkup);
  List<RuleMatch> matches=langTool.check(mapping.getPlainText());
  assertThat("Expected 3 matches, got: " + matches,matches.size(),is(3));
  String markup=origMarkup;
  int oldPos=0;
  for (  RuleMatch match : matches) {
    SuggestionReplacer replacer=new SuggestionReplacer(mapping,markup);
    List<String> newTexts=replacer.applySuggestionsToOriginalText(match);
    assertThat(newTexts.size(),is(1));
    String newText=newTexts.get(0);
    assertThat(StringUtils.countMatches(newText,"absichtlicher absichtlicher"),is(2));
    int pos=newText.indexOf("in absichtlicher Fehler");
    assertTrue(pos > oldPos);
    oldPos=pos;
  }
}
