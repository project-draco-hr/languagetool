{
  ArrayList<Span> spans=new ArrayList<>();
  for (  RuleMatch match : matches) {
    Span span=new Span();
    span.start=match.getFromPos();
    span.end=match.getToPos();
    span.msg=(match.getShortMessage() != null && !match.getShortMessage().isEmpty()) ? match.getShortMessage() : match.getMessage();
    span.msg=org.languagetool.gui.Tools.shortenComment(span.msg);
    span.desc=match.getMessage();
    span.replacement=new ArrayList<>();
    span.replacement.addAll(match.getSuggestedReplacements());
    span.spelling=match.getRule().isSpellingRule();
    span.rule=match.getRule().getId();
    span.url=match.getRule().getUrl();
    spans.add(span);
  }
  ruleMatches.clear();
  documentSpans.clear();
  ruleMatches.addAll(matches);
  documentSpans.addAll(spans);
  updateHighlights();
}
