{
  final long startTime=System.currentTimeMillis();
  final int contextSize=DEFAULT_CONTEXT_SIZE;
  XmlPrintMode xmlMode=StringTools.XmlPrintMode.START_XML;
  final List<RuleMatch> ruleMatches=new ArrayList<>();
  int matchCount=0;
  int sentCount=0;
  for (  StringPair srcAndTrg : reader) {
    final List<RuleMatch> curMatches=checkBitext(srcAndTrg.getSource(),srcAndTrg.getTarget(),srcLt,trgLt,bRules);
    final List<RuleMatch> fixedMatches=new ArrayList<>();
    for (    RuleMatch thisMatch : curMatches) {
      fixedMatches.add(trgLt.adjustRuleMatchPos(thisMatch,reader.getSentencePosition(),reader.getColumnCount(),reader.getLineCount(),reader.getCurrentLine(),null));
    }
    ruleMatches.addAll(fixedMatches);
    if (fixedMatches.size() > 0) {
      if (apiFormat) {
        final String xml=StringTools.ruleMatchesToXML(fixedMatches,reader.getCurrentLine(),contextSize,xmlMode);
        if (xmlMode == StringTools.XmlPrintMode.START_XML) {
          xmlMode=StringTools.XmlPrintMode.CONTINUE_XML;
        }
        final PrintStream out=new PrintStream(System.out,true,"UTF-8");
        out.print(xml);
      }
 else {
        printMatches(fixedMatches,matchCount,reader.getCurrentLine(),contextSize);
        matchCount+=fixedMatches.size();
      }
    }
    sentCount++;
  }
  displayTimeStats(startTime,sentCount,apiFormat);
  if (apiFormat) {
    final PrintStream out=new PrintStream(System.out,true,"UTF-8");
    out.print("</matches>");
  }
  return ruleMatches.size();
}
