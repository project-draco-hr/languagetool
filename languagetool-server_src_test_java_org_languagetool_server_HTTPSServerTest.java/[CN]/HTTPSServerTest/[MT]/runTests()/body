{
  try {
    final String httpPrefix="http://localhost:" + HTTPTools.getDefaultPort() + "/";
    HTTPTools.checkAtUrl(new URL(httpPrefix + "?text=a+test&language=en"));
    fail("HTTP should not work, only HTTPS");
  }
 catch (  SocketException expected) {
  }
  final String httpsPrefix="https://localhost:" + HTTPTools.getDefaultPort() + "/";
  final String result=HTTPTools.checkAtUrl(new URL(httpsPrefix + "?text=a+test.&language=en"));
  assertTrue("Got " + result,result.contains("UPPERCASE_SENTENCE_START"));
  final StringBuilder longText=new StringBuilder();
  while (longText.length() < 490) {
    longText.append("B ");
  }
  final String result2=HTTPTools.checkAtUrl(new URL(httpsPrefix + "?text=" + encode(longText.toString())+ "&language=en"));
  assertTrue("Got " + result2,!result2.contains("UPPERCASE_SENTENCE_START"));
  assertTrue("Got " + result2,result2.contains("PHRASE_REPETITION"));
  final String overlyLongText=longText.toString() + " and some more to get over the limit of 500";
  try {
    System.out.println("=== Now checking text that is too long, please ignore the following exception ===");
    HTTPTools.checkAtUrl(new URL(httpsPrefix + "?text=" + encode(overlyLongText)+ "&language=en"));
    fail();
  }
 catch (  IOException expected) {
  }
}
