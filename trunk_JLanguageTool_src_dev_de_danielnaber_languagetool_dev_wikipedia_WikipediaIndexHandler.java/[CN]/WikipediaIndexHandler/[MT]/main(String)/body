{
  if (args.length != 2) {
    System.out.println("Usage: " + WikipediaIndexHandler.class.getSimpleName() + " <wikipediaDump> <indexDir>");
    System.exit(1);
  }
  final long start=System.currentTimeMillis();
  final SAXParserFactory factory=SAXParserFactory.newInstance();
  final SAXParser saxParser=factory.newSAXParser();
  final FSDirectory fsDirectory=FSDirectory.open(new File(args[1]));
  final WikipediaIndexHandler handler=new WikipediaIndexHandler(fsDirectory,Language.ENGLISH,1,10000);
  try {
    saxParser.parse(new FileInputStream(new File(args[0])),handler);
  }
  finally {
    handler.close();
  }
  final long end=System.currentTimeMillis();
  final float minutes=(end - start) / (float)(1000 * 60);
  System.out.printf("Indexing took %.2f minutes",minutes);
}
