{
  if (qName.equals("category")) {
    final String catName=attrs.getValue("name");
    final String priorityStr=attrs.getValue("priority");
    if (priorityStr != null) {
      category=new Category(catName,Integer.parseInt(priorityStr));
    }
 else {
      category=new Category(catName);
    }
    if ("off".equals(attrs.getValue(DEFAULT))) {
      category.setDefaultOff();
    }
  }
 else   if (qName.equals("rules")) {
    final String languageStr=attrs.getValue("targetLang");
    language=Language.getLanguageForShortName(languageStr);
    if (language == null) {
      throw new SAXException("Unknown language '" + languageStr + "'");
    }
  }
 else   if (qName.equals("rule")) {
    id=attrs.getValue("id");
    if (inRuleGroup)     subId++;
    if (!(inRuleGroup && defaultOff)) {
      defaultOff="off".equals(attrs.getValue(DEFAULT));
    }
    if (!(inRuleGroup && defaultOn)) {
      defaultOn="on".equals(attrs.getValue(DEFAULT));
    }
    if (inRuleGroup && id == null) {
      id=ruleGroupId;
    }
    description=attrs.getValue("name");
    if (inRuleGroup && description == null) {
      description=ruleGroupDescription;
    }
    correctExamples=new ArrayList<StringPair>();
    incorrectExamples=new ArrayList<IncorrectBitextExample>();
    if (suggestionMatches != null) {
      suggestionMatches.clear();
    }
  }
 else   if (qName.equals("pattern")) {
    inPattern=true;
    if (attrs.getValue("mark_from") != null) {
      startPositionCorrection=Integer.parseInt(attrs.getValue("mark_from"));
    }
    if (attrs.getValue("mark_to") != null) {
      endPositionCorrection=Integer.parseInt(attrs.getValue("mark_to"));
      if (endPositionCorrection > 0) {
        throw new SAXException("End position correction (mark_to=" + endPositionCorrection + ") cannot be larger than 0: "+ "\n Line: "+ pLocator.getLineNumber()+ ", column: "+ pLocator.getColumnNumber()+ ".");
      }
    }
    caseSensitive=YES.equals(attrs.getValue("case_sensitive"));
  }
 else   if (qName.equals("and")) {
    inAndGroup=true;
  }
 else   if (qName.equals("unify")) {
    inUnification=true;
    uniNegation=YES.equals(attrs.getValue("negate"));
  }
 else   if (qName.equals("feature")) {
    uFeature=attrs.getValue("id");
  }
 else   if (qName.equals(TYPE)) {
    uType=attrs.getValue("id");
    uTypeList.add(uType);
  }
 else   if (qName.equals("token")) {
    inToken=true;
    if (lastPhrase) {
      elementList.clear();
    }
    lastPhrase=false;
    tokenNegated=YES.equals(attrs.getValue(NEGATE));
    tokenInflected=YES.equals(attrs.getValue(INFLECTED));
    if (attrs.getValue("skip") != null) {
      skipPos=Integer.parseInt(attrs.getValue("skip"));
    }
    elements=new StringBuilder();
    if (attrs.getValue(POSTAG) != null) {
      posToken=attrs.getValue(POSTAG);
      posRegExp=YES.equals(attrs.getValue(POSTAG_REGEXP));
      posNegation=YES.equals(attrs.getValue(NEGATE_POS));
    }
    regExpression=YES.equals(attrs.getValue(REGEXP));
    if (attrs.getValue(SPACEBEFORE) != null) {
      tokenSpaceBefore=YES.equals(attrs.getValue(SPACEBEFORE));
      tokenSpaceBeforeSet=!"ignore".equals(attrs.getValue(SPACEBEFORE));
    }
    if (!inAndGroup) {
      tokenCounter++;
    }
  }
 else   if (qName.equals("exception")) {
    setExceptions(attrs);
  }
 else   if (qName.equals(EXAMPLE) && attrs.getValue(TYPE).equals("correct")) {
    inCorrectExample=true;
    correctExample=new StringBuilder();
  }
 else   if (qName.equals(EXAMPLE) && attrs.getValue(TYPE).equals("incorrect")) {
    inIncorrectExample=true;
    incorrectExample=new StringBuilder();
    exampleCorrection=new StringBuilder();
    if (attrs.getValue("correction") != null) {
      exampleCorrection.append(attrs.getValue("correction"));
    }
  }
 else   if (qName.equals("message")) {
    inMessage=true;
    message=new StringBuilder();
  }
 else   if (qName.equals("short")) {
    inShortMessage=true;
    shortMessage=new StringBuilder();
  }
 else   if (qName.equals("rulegroup")) {
    ruleGroupId=attrs.getValue("id");
    ruleGroupDescription=attrs.getValue("name");
    defaultOff="off".equals(attrs.getValue(DEFAULT));
    defaultOn="on".equals(attrs.getValue(DEFAULT));
    inRuleGroup=true;
    subId=0;
  }
 else   if (qName.equals("suggestion") && inMessage) {
    message.append("<suggestion>");
    inSuggestion=true;
  }
 else   if (qName.equals("match")) {
    setMatchElement(attrs);
  }
 else   if (qName.equals(MARKER) && inCorrectExample) {
    correctExample.append("<marker>");
  }
 else   if (qName.equals(MARKER) && inIncorrectExample) {
    incorrectExample.append("<marker>");
  }
 else   if (qName.equals("unification")) {
    uFeature=attrs.getValue("feature");
    inUnificationDef=true;
  }
 else   if (qName.equals("equivalence")) {
    uType=attrs.getValue(TYPE);
  }
 else   if (qName.equals("phrases")) {
    inPhrases=true;
  }
 else   if (qName.equals("includephrases")) {
    phraseElementInit();
  }
 else   if (qName.equals("phrase") && inPhrases) {
    phraseId=attrs.getValue("id");
  }
 else   if (qName.equals("phraseref") && (attrs.getValue("idref") != null)) {
    phraseIdRef=attrs.getValue("idref");
    if (phraseMap.containsKey(phraseIdRef)) {
      for (      final List<Element> curPhrEl : phraseMap.get(phraseIdRef)) {
        for (        final Element e : curPhrEl) {
          e.setPhraseName(phraseIdRef);
        }
        if (elementList.isEmpty()) {
          phraseElementList.add(new ArrayList<Element>(curPhrEl));
        }
 else {
          final ArrayList<Element> prevList=new ArrayList<Element>(elementList);
          prevList.addAll(curPhrEl);
          phraseElementList.add(new ArrayList<Element>(prevList));
          prevList.clear();
        }
      }
      lastPhrase=true;
    }
  }
 else   if (qName.equals("source")) {
    srcLang=Language.getLanguageForShortName(attrs.getValue("lang"));
  }
}
