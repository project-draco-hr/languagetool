{
  if (langTool == null) {
    try {
      config=new Configuration(new File(System.getProperty("user.home")),CONFIG_FILE,currentLanguage);
      resultArea.setConfiguration(config);
      final ConfigurationDialog configDialog=getCurrentConfigDialog(currentLanguage);
      langTool=new JLanguageTool(currentLanguage,configDialog.getMotherTongue());
      langTool.activateDefaultPatternRules();
      langTool.activateDefaultFalseFriendRules();
      resultArea.setLanguageTool(langTool);
      final Set<String> disabledRules=configDialog.getDisabledRuleIds();
      if (disabledRules != null) {
        for (        final String ruleId : disabledRules) {
          langTool.disableRule(ruleId);
        }
      }
      final Set<String> disabledCategories=configDialog.getDisabledCategoryNames();
      if (disabledCategories != null) {
        for (        final String categoryName : disabledCategories) {
          langTool.disableCategory(categoryName);
        }
      }
      final Set<String> enabledRules=configDialog.getEnabledRuleIds();
      if (enabledRules != null) {
        for (        String ruleName : enabledRules) {
          langTool.enableDefaultOffRule(ruleName);
          langTool.enableRule(ruleName);
        }
      }
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
  return langTool;
}
