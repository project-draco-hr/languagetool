{
  int s=0;
  while ((nindex < inArray.length) && !ISSPACE(nindex)) {
    if (!allowhash && inArray[nindex] == '#' && !ISESC(nindex)) {
      s+=SKIPLN_N();
      nindex--;
    }
    if (ISNL(nindex)) {
      ++s;
      ++nindex;
    }
    if (inArray[nindex] == ';' && !ISESC(nindex)) {
      break;
    }
    if (inArray[nindex] == b && !ISESC(nindex)) {
      break;
    }
    ++nindex;
  }
  return s;
}
