{
  Language lang;
  String langParam=parameters.get("language");
  if (getLanguageAutoDetect(parameters)) {
    lang=detectLanguageOfString(text,null,preferredVariants);
  }
 else {
    if (langParam == null) {
      throw new IllegalArgumentException("Missing 'language' parameter");
    }
    lang=Languages.getLanguageForShortName(langParam);
  }
  return lang;
}
