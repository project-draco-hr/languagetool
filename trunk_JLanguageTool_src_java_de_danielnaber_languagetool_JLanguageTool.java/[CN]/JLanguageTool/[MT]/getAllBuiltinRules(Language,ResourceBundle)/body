{
  final List<Rule> rules=new ArrayList<Rule>();
  final List<Class<? extends Rule>> languageRules=language.getRelevantRules();
  for (  Class<? extends Rule> ruleClass : languageRules) {
    final Constructor[] constructors=ruleClass.getConstructors();
    try {
      for (      final Constructor constructor : constructors) {
        final Class[] paramTypes=constructor.getParameterTypes();
        if (paramTypes.length == 1 && paramTypes[0].equals(ResourceBundle.class)) {
          rules.add((Rule)constructor.newInstance(messages));
          break;
        }
        if (paramTypes.length == 2 && paramTypes[0].equals(ResourceBundle.class) && paramTypes[1].equals(Language.class)) {
          rules.add((Rule)constructor.newInstance(messages,language));
          break;
        }
        throw new RuntimeException("Unknown constructor for rule class: " + ruleClass.getName());
      }
    }
 catch (    Exception e) {
      throw new RuntimeException("Failed to load rules for language " + language,e);
    }
  }
  return rules.toArray(new Rule[rules.size()]);
}
