{
  final String filename=file.getName();
  final String[] parts=filename.split("-");
  if (parts.length < 3) {
    throw new IOException("Unexpected filename format: " + file.getName() + ". Must be like ??wiki-????????-pages-articles.xml");
  }
  final SimpleDateFormat sdf=new SimpleDateFormat("yyyyMMdd");
  try {
    return sdf.parse(parts[1]);
  }
 catch (  ParseException e) {
    throw new IOException("Unexpected date format: " + parts[1],e);
  }
}
