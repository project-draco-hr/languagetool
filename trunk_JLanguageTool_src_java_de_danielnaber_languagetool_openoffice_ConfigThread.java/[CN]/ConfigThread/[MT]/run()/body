{
  try {
    JLanguageTool langTool=new JLanguageTool(docLanguage,cfgDialog.getMotherTongue());
    langTool.activateDefaultPatternRules();
    langTool.activateDefaultFalseFriendRules();
    cfgDialog.show(langTool.getAllRules());
    config.setDisabledRuleIds(cfgDialog.getDisabledRuleIds());
    config.setDisabledCategoryNames(cfgDialog.getDisabledCategoryNames());
    config.setMotherTongue(cfgDialog.getMotherTongue());
    config.saveConfiguration();
  }
 catch (  Throwable e) {
    done=true;
    Main.showError(e);
  }
}
