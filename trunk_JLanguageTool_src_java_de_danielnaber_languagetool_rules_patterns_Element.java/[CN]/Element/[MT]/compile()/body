{
  if ("".equals(referenceString)) {
    referenceString=stringToken;
  }
  final boolean setsPos=tokenReference.setsPos();
  if (!setsPos) {
    stringToken=referenceString.replace("\\" + tokenReference.getTokenRef(),tokenReference.toTokenString());
  }
  if (!"".equals(stringToken) && stringRegExp) {
    regToken=stringToken;
    if (!caseSensitive) {
      regToken=CASE_INSENSITIVE + stringToken;
    }
    p=Pattern.compile(regToken);
  }
  if (setsPos) {
    final String posReference=tokenReference.getTargetPosTag();
    if (posReference != null) {
      if (mPos != null) {
        mPos=null;
      }
      setPosElement(posReference,tokenReference.posRegExp(),negation);
    }
    stringToken=referenceString.replace("\\" + tokenReference.getTokenRef(),"");
    inflected=true;
  }
}
