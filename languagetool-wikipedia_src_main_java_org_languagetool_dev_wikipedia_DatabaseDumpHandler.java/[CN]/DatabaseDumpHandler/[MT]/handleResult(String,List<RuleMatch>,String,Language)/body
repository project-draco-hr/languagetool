{
  final String sql="INSERT INTO corpus_match " + "(version, language_code, ruleid, rule_subid, rule_description, message, error_context, corpus_date, " + "check_date, sourceuri, is_visible) "+ "VALUES (0, ?, ?, ?, ?, ?, ?, ?, ?, ?, 1)";
  try (PreparedStatement prepSt=conn.prepareStatement(sql)){
    final java.sql.Date dumpSqlDate=new java.sql.Date(dumpDate.getTime());
    final java.sql.Date nowDate=new java.sql.Date(new Date().getTime());
    for (    RuleMatch match : ruleMatches) {
      prepSt.setString(1,language.getShortName());
      final Rule rule=match.getRule();
      prepSt.setString(2,rule.getId());
      if (rule instanceof PatternRule) {
        final PatternRule patternRule=(PatternRule)rule;
        prepSt.setString(3,patternRule.getSubId());
      }
 else {
        prepSt.setNull(3,Types.VARCHAR);
      }
      prepSt.setString(4,rule.getDescription());
      prepSt.setString(5,StringUtils.abbreviate(match.getMessage(),255));
      final String context=contextTools.getContext(match.getFromPos(),match.getToPos(),text);
      if (context.length() > 255) {
        continue;
      }
      prepSt.setString(6,context);
      prepSt.setDate(7,dumpSqlDate);
      prepSt.setDate(8,nowDate);
      prepSt.setString(9,URL_PREFIX.replaceAll(LANG_MARKER,langCode) + title);
      prepSt.executeUpdate();
      errorCount++;
      if (maxErrors > 0 && errorCount >= maxErrors) {
        throw new ErrorLimitReachedException(maxErrors);
      }
    }
  }
 }
