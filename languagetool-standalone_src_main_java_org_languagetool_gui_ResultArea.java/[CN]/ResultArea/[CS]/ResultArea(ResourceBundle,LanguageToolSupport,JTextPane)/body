{
  this.messages=messages;
  this.ltSupport=ltSupport;
  this.statusPane=statusPane;
  statusPane.setContentType("text/html");
  statusPane.setText(Main.HTML_GREY_FONT_START + messages.getString("resultAreaText") + Main.HTML_FONT_END);
  statusPane.setEditable(false);
  statusPane.addHyperlinkListener(new MyHyperlinkListener());
  statusPane.setTransferHandler(new RetainLineBreakTransferHandler());
  ltSupport.addLanguageToolListener(new LanguageToolListener(){
    @Override public void languageToolEventOccurred(    LanguageToolEvent event){
      if (event.getType() == LanguageToolEvent.Type.CHECKING_STARTED) {
        final Language lang=ltSupport.getLanguage();
        final String langName;
        if (lang.isExternal()) {
          langName=lang.getTranslatedName(messages) + Main.EXTERNAL_LANGUAGE_SUFFIX;
        }
 else {
          langName=lang.getTranslatedName(messages);
        }
        final String startCheckText=Main.HTML_GREY_FONT_START + org.languagetool.tools.Tools.i18n(messages,"startChecking",langName) + "..."+ Main.HTML_FONT_END;
        statusPane.setText(startCheckText);
        setStartText(startCheckText);
        if (event.getCaller() == this) {
          statusPane.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
        }
      }
 else       if (event.getType() == LanguageToolEvent.Type.CHECKING_FINISHED) {
        setRunTime(event.getElapsedTime());
        inputText=event.getSource().getTextComponent().getText();
        setRuleMatches(event.getSource().getMatches());
        displayResult();
        if (event.getCaller() == this) {
          statusPane.setCursor(Cursor.getDefaultCursor());
        }
      }
 else       if (event.getType() == LanguageToolEvent.Type.RULE_DISABLED || event.getType() == LanguageToolEvent.Type.RULE_ENABLED) {
        inputText=event.getSource().getTextComponent().getText();
        setRuleMatches(event.getSource().getMatches());
        displayResult();
      }
    }
  }
);
}
