{
  final Properties props=new Properties();
  final String qualifier=getQualifier(lang);
  addListToProperties(props,DISABLED_RULES_CONFIG_KEY + qualifier,disabledRuleIds);
  addListToProperties(props,ENABLED_RULES_CONFIG_KEY + qualifier,enabledRuleIds);
  addListToProperties(props,DISABLED_CATEGORIES_CONFIG_KEY + qualifier,disabledCategoryNames);
  if (language != null) {
    props.setProperty(LANGUAGE_CONFIG_KEY,language.getShortNameWithVariant());
  }
  if (motherTongue != null) {
    props.setProperty(MOTHER_TONGUE_CONFIG_KEY,motherTongue.getShortName());
  }
  props.setProperty(AUTO_DETECT_CONFIG_KEY,Boolean.valueOf(autoDetect).toString());
  props.setProperty(USE_GUI_CONFIG_KEY,Boolean.valueOf(guiConfig).toString());
  props.setProperty(SERVER_RUN_CONFIG_KEY,Boolean.valueOf(runServer).toString());
  props.setProperty(SERVER_PORT_CONFIG_KEY,Integer.valueOf(serverPort).toString());
  for (  final String key : configForOtherLangs.keySet()) {
    props.setProperty(key,configForOtherLangs.get(key));
  }
  final FileOutputStream fos=new FileOutputStream(configFile);
  try {
    props.store(fos,"LanguageTool configuration");
  }
  finally {
    fos.close();
  }
}
