{
  final CommandLineParser commandLineParser=new CommandLineParser();
  CommandLineOptions options=null;
  try {
    options=commandLineParser.parseOptions(args);
  }
 catch (  IllegalArgumentException e) {
    if (e.getMessage() != null) {
      System.err.println(e.getMessage());
    }
    commandLineParser.printUsage();
    System.exit(1);
  }
  if (options.isPrintVersion()) {
    System.out.println("LanguageTool version " + JLanguageTool.VERSION);
    System.exit(0);
  }
  if (options.isPrintLanguages()) {
    printLanguages();
    System.exit(0);
  }
  if (options.getFilename() == null) {
    options.setFilename("-");
  }
  if (options.getLanguage() == null) {
    if (!options.isApiFormat() && !options.isAutoDetect()) {
      System.err.println("No language specified, using English");
    }
    options.setLanguage(Language.ENGLISH);
  }
 else   if (!options.isApiFormat() && !options.isApplySuggestions()) {
    System.out.println("Expected text language: " + options.getLanguage().getName());
  }
  options.getLanguage().getSentenceTokenizer().setSingleLineBreaksMarksParagraph(options.isSingleLineBreakMarksParagraph());
  final Main prg=new Main(options.isVerbose(),options.isTaggerOnly(),options.getLanguage(),options.getMotherTongue(),options.getDisabledRules(),options.getEnabledRules(),options.isApiFormat(),options.isApplySuggestions(),options.isAutoDetect(),options.isSingleLineBreakMarksParagraph());
  prg.setListUnknownWords(options.isListUnknown());
  if (options.isProfile()) {
    prg.setProfilingMode();
  }
  if (options.isBitext()) {
    if (options.getMotherTongue() == null) {
      throw new IllegalArgumentException("You have to set the source language (as mother tongue) in bitext mode.");
    }
    prg.setBitextMode(options.getMotherTongue(),options.getDisabledRules(),options.getEnabledRules());
  }
  if (options.isRecursive()) {
    prg.runRecursive(options.getFilename(),options.getEncoding(),options.isListUnknown(),options.isXmlFiltering());
  }
 else {
    prg.runOnFile(options.getFilename(),options.getEncoding(),options.isListUnknown(),options.isXmlFiltering());
  }
  prg.cleanUp();
}
