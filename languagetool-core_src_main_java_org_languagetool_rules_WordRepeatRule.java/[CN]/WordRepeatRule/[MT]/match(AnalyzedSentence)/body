{
  final List<RuleMatch> ruleMatches=new ArrayList<>();
  final AnalyzedTokenReadings[] tokens=sentence.getTokensWithoutWhitespace();
  String prevToken="";
  for (int i=1; i < tokens.length; i++) {
    final String token=tokens[i].getToken();
    if (tokens[i].isImmunized()) {
      continue;
    }
    if (isWord(token) && prevToken.equalsIgnoreCase(token) && !ignore(tokens,i)) {
      final String msg=messages.getString("repetition");
      final int prevPos=tokens[i - 1].getStartPos();
      final int pos=tokens[i].getStartPos();
      final RuleMatch ruleMatch=createRuleMatch(prevToken,token,prevPos,pos,msg);
      ruleMatches.add(ruleMatch);
    }
    prevToken=token;
  }
  return toRuleMatchArray(ruleMatches);
}
