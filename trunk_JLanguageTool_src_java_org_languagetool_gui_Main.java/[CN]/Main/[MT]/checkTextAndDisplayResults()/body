{
  final Cursor prevCursor=resultArea.getCursor();
  frame.setCursor(new Cursor(Cursor.WAIT_CURSOR));
  final JLanguageTool langTool=getCurrentLanguageTool();
  final Language lang=getCurrentLanguage();
  if (StringTools.isEmpty(textArea.getText().trim())) {
    textArea.setText(messages.getString("enterText2"));
  }
 else {
    final StringBuilder sb=new StringBuilder();
    final String langName;
    if (lang.isExternal()) {
      langName=lang.getTranslatedName(messages) + EXTERNAL_LANGUAGE_SUFFIX;
    }
 else {
      langName=lang.getTranslatedName(messages);
    }
    final String startCheckText=Tools.makeTexti18n(messages,"startChecking",new Object[]{langName});
    resultArea.setText(HTML_FONT_START + startCheckText + "<br>\n"+ HTML_FONT_END);
    resultArea.repaint();
    sb.append(startCheckText);
    sb.append("...<br>\n");
    int matches=0;
    try {
      matches=checkText(langTool,textArea.getText(),sb);
    }
 catch (    final Exception e) {
      sb.append("<br><br><b><font color=\"red\">");
      sb.append(org.languagetool.tools.Tools.getFullStackTrace(e).replace("\n","<br/>"));
      sb.append("</font></b><br>");
    }
    final String checkDone=Tools.makeTexti18n(messages,"checkDone",new Object[]{matches});
    sb.append(checkDone);
    sb.append("<br>\n");
    resultArea.setText(HTML_FONT_START + sb.toString() + HTML_FONT_END);
    resultArea.setCaretPosition(0);
  }
  frame.setCursor(prevCursor);
}
